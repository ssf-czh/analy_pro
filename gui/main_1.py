# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'main_1.ui'
#
# Created by: PyQt5 UI code generator 5.15.4
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.


from PyQt5 import QtCore, QtGui, QtWidgets
import model
from model.db import save, main_fittings, load
from P_pro import PumpFit,Main

class Ui_MainWindow(object):
    def setupUi(self, MainWindow):
        self.PumpFit = PumpFit.PumpFitting()
        MainWindow.setObjectName("MainWindow")
        MainWindow.resize(1239, 754)
        MainWindow.setMinimumSize(QtCore.QSize(1239, 754))
        self.centralwidget = QtWidgets.QWidget(MainWindow)
        self.centralwidget.setObjectName("centralwidget")
        self.verticalLayout_2 = QtWidgets.QVBoxLayout(self.centralwidget)
        self.verticalLayout_2.setObjectName("verticalLayout_2")
        self.stackedWidget = QtWidgets.QStackedWidget(self.centralwidget)
        self.stackedWidget.setObjectName("stackedWidget")
        self.page = QtWidgets.QWidget()
        self.page.setObjectName("page")
        self.horizontalLayout_10 = QtWidgets.QHBoxLayout(self.page)
        self.horizontalLayout_10.setObjectName("horizontalLayout_10")
        self.gridLayout = QtWidgets.QGridLayout()
        self.gridLayout.setObjectName("gridLayout")
        spacerItem = QtWidgets.QSpacerItem(40, 20, QtWidgets.QSizePolicy.MinimumExpanding, QtWidgets.QSizePolicy.Minimum)
        self.gridLayout.addItem(spacerItem, 0, 1, 1, 1)
        spacerItem1 = QtWidgets.QSpacerItem(40, 20, QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Minimum)
        self.gridLayout.addItem(spacerItem1, 2, 0, 1, 1)
        self.verticalLayout = QtWidgets.QVBoxLayout()
        self.verticalLayout.setObjectName("verticalLayout")
        self.horizontalLayout = QtWidgets.QHBoxLayout()
        self.horizontalLayout.setObjectName("horizontalLayout")
        self.label = QtWidgets.QLabel(self.page)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Preferred, QtWidgets.QSizePolicy.Preferred)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.label.sizePolicy().hasHeightForWidth())
        self.label.setSizePolicy(sizePolicy)
        font = QtGui.QFont()
        font.setPointSize(12)
        self.label.setFont(font)
        self.label.setObjectName("label")
        self.horizontalLayout.addWidget(self.label)
        self.comboBox = QtWidgets.QComboBox(self.page)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Fixed, QtWidgets.QSizePolicy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.comboBox.sizePolicy().hasHeightForWidth())
        self.comboBox.setSizePolicy(sizePolicy)
        font = QtGui.QFont()
        font.setPointSize(12)
        self.comboBox.setFont(font)
        self.comboBox.setObjectName("comboBox")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.horizontalLayout.addWidget(self.comboBox)
        self.verticalLayout.addLayout(self.horizontalLayout)
        self.horizontalLayout_2 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_2.setObjectName("horizontalLayout_2")
        self.label_2 = QtWidgets.QLabel(self.page)
        font = QtGui.QFont()
        font.setPointSize(12)
        self.label_2.setFont(font)
        self.label_2.setObjectName("label_2")
        self.horizontalLayout_2.addWidget(self.label_2)
        self.comboBox_2 = QtWidgets.QComboBox(self.page)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Fixed, QtWidgets.QSizePolicy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.comboBox_2.sizePolicy().hasHeightForWidth())
        self.comboBox_2.setSizePolicy(sizePolicy)
        font = QtGui.QFont()
        font.setPointSize(12)
        self.comboBox_2.setFont(font)
        self.comboBox_2.setObjectName("comboBox_2")
        self.comboBox_2.addItem("")
        self.comboBox_2.addItem("")
        self.comboBox_2.addItem("")
        self.horizontalLayout_2.addWidget(self.comboBox_2)
        self.verticalLayout.addLayout(self.horizontalLayout_2)
        self.horizontalLayout_3 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_3.setObjectName("horizontalLayout_3")
        self.label_3 = QtWidgets.QLabel(self.page)
        font = QtGui.QFont()
        font.setPointSize(12)
        self.label_3.setFont(font)
        self.label_3.setObjectName("label_3")
        self.horizontalLayout_3.addWidget(self.label_3)
        self.comboBox_3 = QtWidgets.QComboBox(self.page)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Fixed, QtWidgets.QSizePolicy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.comboBox_3.sizePolicy().hasHeightForWidth())
        self.comboBox_3.setSizePolicy(sizePolicy)
        font = QtGui.QFont()
        font.setPointSize(12)
        self.comboBox_3.setFont(font)
        self.comboBox_3.setObjectName("comboBox_3")
        self.comboBox_3.addItem("")
        self.comboBox_3.addItem("")
        self.horizontalLayout_3.addWidget(self.comboBox_3)
        self.verticalLayout.addLayout(self.horizontalLayout_3)
        self.gridLayout.addLayout(self.verticalLayout, 0, 0, 1, 1)
        self.init_params = QtWidgets.QTableWidget(self.page)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Preferred, QtWidgets.QSizePolicy.Expanding)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.init_params.sizePolicy().hasHeightForWidth())
        self.init_params.setSizePolicy(sizePolicy)
        self.init_params.setBaseSize(QtCore.QSize(0, 7))
        font = QtGui.QFont()
        font.setStyleStrategy(QtGui.QFont.PreferAntialias)
        self.init_params.setFont(font)
        self.init_params.setLocale(QtCore.QLocale(QtCore.QLocale.Estonian, QtCore.QLocale.Estonia))
        self.init_params.setVerticalScrollBarPolicy(QtCore.Qt.ScrollBarAsNeeded)
        self.init_params.setHorizontalScrollBarPolicy(QtCore.Qt.ScrollBarAsNeeded)
        self.init_params.setSizeAdjustPolicy(QtWidgets.QAbstractScrollArea.AdjustToContents)
        self.init_params.setEditTriggers(QtWidgets.QAbstractItemView.AnyKeyPressed|QtWidgets.QAbstractItemView.DoubleClicked|QtWidgets.QAbstractItemView.EditKeyPressed)
        self.init_params.setRowCount(35)
        self.init_params.setColumnCount(20)
        self.init_params.setObjectName("init_params")
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(0, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(0, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(0, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(0, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(0, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(0, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(0, 6, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(0, 7, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(0, 8, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(0, 9, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(1, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(1, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(1, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(1, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(1, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(1, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(1, 6, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(1, 7, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(1, 8, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(1, 9, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(2, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(3, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(3, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(4, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(4, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(5, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(5, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(6, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(6, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(7, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(7, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(8, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(8, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(9, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(9, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(10, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(10, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(11, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(11, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(12, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(12, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(13, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(13, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(14, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(14, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(15, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(15, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(16, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(16, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(17, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(17, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(18, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(18, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(19, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(19, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(20, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(20, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(21, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(21, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(22, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(22, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(22, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(23, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(23, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(23, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(24, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(24, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(25, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(26, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(26, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(26, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(27, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(27, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.init_params.setItem(27, 2, item)
        self.init_params.horizontalHeader().setDefaultSectionSize(256)
        self.init_params.verticalHeader().setDefaultSectionSize(36)
        self.init_params.verticalHeader().setMinimumSectionSize(28)
        self.gridLayout.addWidget(self.init_params, 1, 0, 1, 2)
        self.horizontalLayout_8 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_8.setObjectName("horizontalLayout_8")
        self.B1_1 = QtWidgets.QPushButton(self.page)


        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Fixed, QtWidgets.QSizePolicy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.B1_1.sizePolicy().hasHeightForWidth())
        self.B1_1.setSizePolicy(sizePolicy)
        font = QtGui.QFont()
        font.setPointSize(12)
        self.B1_1.setFont(font)
        self.B1_1.setObjectName("B1_1")

        # 绑定按钮事件 保存参数到文件
        def init_parm_save():
            item = self.init_params.item(3, 1)
            model.db.init_params.q = item.data(0)

            item = self.init_params.item(4, 1)
            model.db.init_params.n = item.data(0)

            item = self.init_params.item(5, 1)
            model.db.init_params.efficiency_range = item.data(0)

            item = self.init_params.item(6, 1)
            model.db.init_params.q_min = item.data(0)

            item = self.init_params.item(7, 1)
            model.db.init_params.t3_min = item.data(0)

            item = self.init_params.item(9, 1)
            model.db.init_params.G20 = item.data(0)

            item = self.init_params.item(10, 1)
            model.db.init_params.h = item.data(0)



            item = self.init_params.item(11, 1)
            model.db.init_params.p2 = item.data(0)


            # item = self.init_params.item(12, 0)
            # item.setText(_translate("MainWindow", "冷冻水泵台数,台"))
            # item = self.init_params.item(12, 1)
            # item.setText(_translate("MainWindow", ""))
            # item = self.init_params.item(13, 0)
            # item.setText(_translate("MainWindow", "冷冻水泵变频频率下限值μ"))

            item = self.init_params.item(13, 1)
            model.db.init_params.mu = item.data(0)

            # item = self.init_params.item(15, 0)
            # item.setText(_translate("MainWindow", "单台冷却水泵的额定流量G30，m3/h"))

            item = self.init_params.item(15, 1)
            model.db.init_params.G20 = item.data(0)
            # item = self.init_params.item(16, 0)
            # item.setText(_translate("MainWindow", "单台冷却水泵扬程H，m"))
            # item = self.init_params.item(16, 1)
            # item.setText(_translate("MainWindow", ""))

            # item = self.init_params.item(17, 0)
            # model.db.init_params.p3 = item.data(0)
            # item = self.init_params.item(17, 1)
            # item.setText(_translate("MainWindow", ""))
            # item = self.init_params.item(18, 0)
            # item.setText(_translate("MainWindow", "冷却水泵最多台数,台"))
            # item = self.init_params.item(18, 1)
            # item.setText(_translate("MainWindow", ""))

            item = self.init_params.item(19, 1)
            model.db.init_params.lamb = item.data(0)

            #
            # item = self.init_params.item(21, 0)
            # item.setText(_translate("MainWindow", "单台冷却塔的额定流量G，m3/h"))
            # item = self.init_params.item(21, 1)
            # item.setText(_translate("MainWindow", ""))
            # item = self.init_params.item(22, 0)
            # item.setText(_translate("MainWindow", "单台冷却塔风量H，m3/h"))
            # item = self.init_params.item(22, 1)
            # item.setText(_translate("MainWindow", ""))
            # item = self.init_params.item(23, 0)
            # item.setText(_translate("MainWindow", "单台冷却塔功率P0，Kw"))
            # item = self.init_params.item(23, 1)
            # item.setText(_translate("MainWindow", ""))
            # item = self.init_params.item(24, 0)
            # item.setText(_translate("MainWindow", "冷却塔最多台数,台"))
            # item = self.init_params.item(24, 1)
            # item.setText(_translate("MainWindow", ""))

            item = self.init_params.item(26, 1)
            print(item.data(0))
            a = float(item.data(0))
            item = self.init_params.item(26, 2)
            model.db.init_params.delta_t1_range = a, float(item.data(0))
            item = self.init_params.item(27, 1)
            b = item.data(0)
            item = self.init_params.item(27, 2)
            model.db.init_params.delta_t2_range = b, item.data(0)

            save("template.xlsx")
            load("template.xlsx")

        self.B1_1.clicked.connect(init_parm_save)

        self.horizontalLayout_8.addWidget(self.B1_1)


        self.pushButton = QtWidgets.QPushButton(self.page)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Fixed, QtWidgets.QSizePolicy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.pushButton.sizePolicy().hasHeightForWidth())
        self.pushButton.setSizePolicy(sizePolicy)
        font = QtGui.QFont()
        font.setPointSize(12)
        self.pushButton.setFont(font)
        self.pushButton.setObjectName("pushButton")
        self.horizontalLayout_8.addWidget(self.pushButton)
        self.gridLayout.addLayout(self.horizontalLayout_8, 2, 1, 1, 1)
        self.horizontalLayout_10.addLayout(self.gridLayout)
        self.stackedWidget.addWidget(self.page)
        self.page_2 = QtWidgets.QWidget()
        self.page_2.setObjectName("page_2")
        self.horizontalLayout_11 = QtWidgets.QHBoxLayout(self.page_2)
        self.horizontalLayout_11.setObjectName("horizontalLayout_11")
        self.tabWidget = QtWidgets.QTabWidget(self.page_2)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Preferred)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.tabWidget.sizePolicy().hasHeightForWidth())
        self.tabWidget.setSizePolicy(sizePolicy)
        font = QtGui.QFont()
        font.setPointSize(12)
        self.tabWidget.setFont(font)
        self.tabWidget.setObjectName("tabWidget")
        self.tab_6 = QtWidgets.QWidget()
        self.tab_6.setObjectName("tab_6")
        self.horizontalLayout_15 = QtWidgets.QHBoxLayout(self.tab_6)
        self.horizontalLayout_15.setObjectName("horizontalLayout_15")
        self.gridLayout_28 = QtWidgets.QGridLayout()
        self.gridLayout_28.setObjectName("gridLayout_28")
        self.gridLayout_29 = QtWidgets.QGridLayout()
        self.gridLayout_29.setObjectName("gridLayout_29")
        spacerItem2 = QtWidgets.QSpacerItem(40, 20, QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Minimum)
        self.gridLayout_29.addItem(spacerItem2, 0, 0, 1, 1)
        self.horizontalLayout_31 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_31.setObjectName("horizontalLayout_31")
        self.B2_1 = QtWidgets.QPushButton(self.tab_6)
        self.B2_1.setObjectName("B2_1")
        self.horizontalLayout_31.addWidget(self.B2_1)
        self.pushButton_53 = QtWidgets.QPushButton(self.tab_6)
        self.pushButton_53.setObjectName("pushButton_53")
        self.horizontalLayout_31.addWidget(self.pushButton_53)
        self.gridLayout_29.addLayout(self.horizontalLayout_31, 0, 1, 1, 1)
        self.gridLayout_28.addLayout(self.gridLayout_29, 1, 0, 1, 1)
        self.table_21 = QtWidgets.QTableWidget(self.tab_6)
        self.table_21.setRowCount(25)
        self.table_21.setColumnCount(20)
        self.table_21.setObjectName("table_21")
        item = QtWidgets.QTableWidgetItem()
        self.table_21.setItem(0, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_21.setItem(0, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_21.setItem(0, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_21.setItem(0, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_21.setItem(0, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_21.setItem(0, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_21.setItem(0, 6, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_21.setItem(0, 7, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_21.setItem(0, 8, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_21.setItem(1, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_21.setItem(1, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_21.setItem(1, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_21.setItem(1, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_21.setItem(1, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_21.setItem(1, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_21.setItem(1, 6, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_21.setItem(1, 7, item)
        self.gridLayout_28.addWidget(self.table_21, 0, 0, 1, 1)
        self.horizontalLayout_15.addLayout(self.gridLayout_28)
        self.tabWidget.addTab(self.tab_6, "")
        self.tab_7 = QtWidgets.QWidget()
        self.tab_7.setObjectName("tab_7")
        self.horizontalLayout_17 = QtWidgets.QHBoxLayout(self.tab_7)
        self.horizontalLayout_17.setObjectName("horizontalLayout_17")
        self.gridLayout_26 = QtWidgets.QGridLayout()
        self.gridLayout_26.setObjectName("gridLayout_26")
        self.gridLayout_27 = QtWidgets.QGridLayout()
        self.gridLayout_27.setObjectName("gridLayout_27")
        spacerItem3 = QtWidgets.QSpacerItem(40, 20, QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Minimum)
        self.gridLayout_27.addItem(spacerItem3, 0, 0, 1, 1)
        self.horizontalLayout_33 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_33.setObjectName("horizontalLayout_33")
        self.B2_2 = QtWidgets.QPushButton(self.tab_7)
        self.B2_2.setObjectName("B2_2")
        self.horizontalLayout_33.addWidget(self.B2_2)
        self.pushButton_51 = QtWidgets.QPushButton(self.tab_7)
        self.pushButton_51.setObjectName("pushButton_51")
        self.horizontalLayout_33.addWidget(self.pushButton_51)
        self.gridLayout_27.addLayout(self.horizontalLayout_33, 0, 1, 1, 1)
        self.gridLayout_26.addLayout(self.gridLayout_27, 1, 0, 1, 1)
        self.table_22 = QtWidgets.QTableWidget(self.tab_7)
        self.table_22.setDragDropOverwriteMode(True)
        self.table_22.setRowCount(25)
        self.table_22.setColumnCount(20)
        self.table_22.setObjectName("table_22")
        item = QtWidgets.QTableWidgetItem()
        self.table_22.setItem(0, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_22.setItem(0, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_22.setItem(0, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_22.setItem(0, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_22.setItem(0, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_22.setItem(0, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_22.setItem(0, 6, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_22.setItem(0, 7, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_22.setItem(0, 8, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_22.setItem(0, 9, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_22.setItem(0, 10, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_22.setItem(0, 11, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_22.setItem(1, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_22.setItem(1, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_22.setItem(1, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_22.setItem(1, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_22.setItem(1, 6, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_22.setItem(1, 7, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_22.setItem(1, 8, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_22.setItem(1, 9, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_22.setItem(1, 10, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_22.setItem(1, 11, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_22.setItem(2, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_22.setItem(2, 1, item)
        self.table_22.horizontalHeader().setDefaultSectionSize(200)
        self.gridLayout_26.addWidget(self.table_22, 0, 0, 1, 1)
        self.horizontalLayout_17.addLayout(self.gridLayout_26)
        self.tabWidget.addTab(self.tab_7, "")
        self.tab_8 = QtWidgets.QWidget()
        self.tab_8.setObjectName("tab_8")
        self.horizontalLayout_14 = QtWidgets.QHBoxLayout(self.tab_8)
        self.horizontalLayout_14.setObjectName("horizontalLayout_14")
        self.gridLayout_24 = QtWidgets.QGridLayout()
        self.gridLayout_24.setObjectName("gridLayout_24")
        self.gridLayout_25 = QtWidgets.QGridLayout()
        self.gridLayout_25.setObjectName("gridLayout_25")
        spacerItem4 = QtWidgets.QSpacerItem(40, 20, QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Minimum)
        self.gridLayout_25.addItem(spacerItem4, 0, 0, 1, 1)
        self.horizontalLayout_30 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_30.setObjectName("horizontalLayout_30")
        self.B2_3 = QtWidgets.QPushButton(self.tab_8)
        self.B2_3.setObjectName("B2_3")
        self.horizontalLayout_30.addWidget(self.B2_3)
        self.pushButton_49 = QtWidgets.QPushButton(self.tab_8)
        self.pushButton_49.setObjectName("pushButton_49")
        self.horizontalLayout_30.addWidget(self.pushButton_49)
        self.gridLayout_25.addLayout(self.horizontalLayout_30, 0, 1, 1, 1)
        self.gridLayout_24.addLayout(self.gridLayout_25, 1, 0, 1, 1)
        self.table_23 = QtWidgets.QTableWidget(self.tab_8)
        self.table_23.setRowCount(25)
        self.table_23.setColumnCount(20)
        self.table_23.setObjectName("table_23")
        item = QtWidgets.QTableWidgetItem()
        self.table_23.setItem(0, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_23.setItem(0, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_23.setItem(0, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_23.setItem(0, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_23.setItem(0, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_23.setItem(0, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_23.setItem(0, 6, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_23.setItem(0, 7, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_23.setItem(0, 8, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_23.setItem(0, 9, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_23.setItem(0, 10, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_23.setItem(0, 11, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_23.setItem(1, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_23.setItem(1, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_23.setItem(1, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_23.setItem(1, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_23.setItem(1, 6, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_23.setItem(1, 7, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_23.setItem(1, 8, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_23.setItem(1, 9, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_23.setItem(1, 10, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_23.setItem(1, 11, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_23.setItem(2, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_23.setItem(2, 1, item)
        self.table_23.horizontalHeader().setDefaultSectionSize(200)
        self.gridLayout_24.addWidget(self.table_23, 0, 0, 1, 1)
        self.horizontalLayout_14.addLayout(self.gridLayout_24)
        self.tabWidget.addTab(self.tab_8, "")
        self.tab_9 = QtWidgets.QWidget()
        self.tab_9.setObjectName("tab_9")
        self.horizontalLayout_13 = QtWidgets.QHBoxLayout(self.tab_9)
        self.horizontalLayout_13.setObjectName("horizontalLayout_13")
        self.gridLayout_22 = QtWidgets.QGridLayout()
        self.gridLayout_22.setObjectName("gridLayout_22")
        self.gridLayout_23 = QtWidgets.QGridLayout()
        self.gridLayout_23.setObjectName("gridLayout_23")
        spacerItem5 = QtWidgets.QSpacerItem(40, 20, QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Minimum)
        self.gridLayout_23.addItem(spacerItem5, 0, 0, 1, 1)
        self.horizontalLayout_28 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_28.setObjectName("horizontalLayout_28")
        self.B2_4 = QtWidgets.QPushButton(self.tab_9)
        self.B2_4.setObjectName("B2_4")
        self.horizontalLayout_28.addWidget(self.B2_4)
        self.pushButton_47 = QtWidgets.QPushButton(self.tab_9)
        self.pushButton_47.setObjectName("pushButton_47")
        self.horizontalLayout_28.addWidget(self.pushButton_47)
        self.gridLayout_23.addLayout(self.horizontalLayout_28, 0, 1, 1, 1)
        self.gridLayout_22.addLayout(self.gridLayout_23, 1, 0, 1, 1)
        self.table_24 = QtWidgets.QTableWidget(self.tab_9)
        self.table_24.setTabKeyNavigation(True)
        self.table_24.setRowCount(60)
        self.table_24.setColumnCount(20)
        self.table_24.setObjectName("table_24")
        item = QtWidgets.QTableWidgetItem()
        self.table_24.setItem(0, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_24.setItem(0, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_24.setItem(0, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_24.setItem(0, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_24.setItem(0, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_24.setItem(0, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_24.setItem(0, 6, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_24.setItem(34, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_24.setItem(34, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_24.setItem(34, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_24.setItem(34, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_24.setItem(34, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_24.setItem(34, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_24.setItem(34, 6, item)
        self.table_24.horizontalHeader().setDefaultSectionSize(200)
        self.table_24.verticalHeader().setDefaultSectionSize(38)
        self.gridLayout_22.addWidget(self.table_24, 0, 0, 1, 1)
        self.horizontalLayout_13.addLayout(self.gridLayout_22)
        self.tabWidget.addTab(self.tab_9, "")
        self.tab_10 = QtWidgets.QWidget()
        self.tab_10.setObjectName("tab_10")
        self.horizontalLayout_25 = QtWidgets.QHBoxLayout(self.tab_10)
        self.horizontalLayout_25.setObjectName("horizontalLayout_25")
        self.gridLayout_20 = QtWidgets.QGridLayout()
        self.gridLayout_20.setObjectName("gridLayout_20")
        self.gridLayout_21 = QtWidgets.QGridLayout()
        self.gridLayout_21.setObjectName("gridLayout_21")
        spacerItem6 = QtWidgets.QSpacerItem(40, 20, QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Minimum)
        self.gridLayout_21.addItem(spacerItem6, 0, 0, 1, 1)
        self.horizontalLayout_26 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_26.setObjectName("horizontalLayout_26")
        self.B2_5 = QtWidgets.QPushButton(self.tab_10)
        self.B2_5.setObjectName("B2_5")
        self.horizontalLayout_26.addWidget(self.B2_5)
        self.pushButton_41 = QtWidgets.QPushButton(self.tab_10)
        self.pushButton_41.setObjectName("pushButton_41")
        self.horizontalLayout_26.addWidget(self.pushButton_41)
        self.gridLayout_21.addLayout(self.horizontalLayout_26, 0, 1, 1, 1)
        self.gridLayout_20.addLayout(self.gridLayout_21, 1, 0, 1, 1)
        self.table_25 = QtWidgets.QTableWidget(self.tab_10)
        self.table_25.setRowCount(25)
        self.table_25.setColumnCount(20)
        self.table_25.setObjectName("table_25")
        item = QtWidgets.QTableWidgetItem()
        self.table_25.setItem(0, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_25.setItem(0, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_25.setItem(0, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_25.setItem(0, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_25.setItem(0, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_25.setItem(0, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.table_25.setItem(0, 6, item)
        self.table_25.horizontalHeader().setVisible(False)
        self.table_25.horizontalHeader().setDefaultSectionSize(200)
        self.gridLayout_20.addWidget(self.table_25, 0, 0, 1, 1)
        self.horizontalLayout_25.addLayout(self.gridLayout_20)
        self.tabWidget.addTab(self.tab_10, "")
        self.horizontalLayout_11.addWidget(self.tabWidget)
        self.stackedWidget.addWidget(self.page_2)
        self.page_3 = QtWidgets.QWidget()
        self.page_3.setObjectName("page_3")
        self.horizontalLayout_12 = QtWidgets.QHBoxLayout(self.page_3)
        self.horizontalLayout_12.setObjectName("horizontalLayout_12")
        self.tabWidget_2 = QtWidgets.QTabWidget(self.page_3)
        font = QtGui.QFont()
        font.setPointSize(12)
        self.tabWidget_2.setFont(font)
        self.tabWidget_2.setElideMode(QtCore.Qt.ElideLeft)
        self.tabWidget_2.setObjectName("tabWidget_2")
        self.tab_11 = QtWidgets.QWidget()
        self.tab_11.setObjectName("tab_11")
        self.horizontalLayout_29 = QtWidgets.QHBoxLayout(self.tab_11)
        self.horizontalLayout_29.setObjectName("horizontalLayout_29")
        self.verticalLayout_3 = QtWidgets.QVBoxLayout()
        self.verticalLayout_3.setObjectName("verticalLayout_3")
        self.main_fittings = QtWidgets.QTableWidget(self.tab_11)
        self.main_fittings.setRowCount(25)
        self.main_fittings.setColumnCount(20)
        self.main_fittings.setObjectName("main_fittings")
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(0, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(0, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(0, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(0, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(0, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(0, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(0, 6, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(0, 7, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(1, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(1, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(1, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(1, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(1, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(1, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(1, 6, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(1, 7, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(1, 8, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(1, 9, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(1, 10, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(1, 11, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(1, 12, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(1, 13, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(2, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(2, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(2, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(2, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(2, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(2, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(2, 6, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(2, 7, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(3, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(3, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(3, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(3, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(3, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(3, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(3, 6, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(3, 7, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(3, 8, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(3, 9, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(3, 10, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(3, 11, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(3, 12, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(5, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(8, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(9, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(11, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.main_fittings.setItem(12, 0, item)
        self.main_fittings.horizontalHeader().setDefaultSectionSize(133)
        self.verticalLayout_3.addWidget(self.main_fittings)
        self.horizontalLayout_16 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_16.setObjectName("horizontalLayout_16")
        self.B3_11 = QtWidgets.QPushButton(self.tab_11)
        self.B3_11.setObjectName("B3_11")
        # ==
        def fitting_P1():
            _translate = QtCore.QCoreApplication.translate
            # print(11)
            p1_data = model.db.main_fittings
            print(len(p1_data))
            # p2_data = model.db.pump2_fittings
            # for i in p2_data:
            #     print(i.g2)
            #     print(i.p2)
            # p3_data = model.db.pump3_fittings
            # web_data = model.db.wet_bulb_fittings
            # p4_data = model.db.p4_fittings
            B = self.PumpFit.fit_P1(p1_data)
            print(B)
            for i in range(12):
                item = QtWidgets.QTableWidgetItem()
                self.main_fittings.setItem(2, i+1, item)
                item = self.main_fittings.item(2, i+1)
                item.setText(_translate("MainWindow", str(B[i])))
            for i in range(12):
                item = QtWidgets.QTableWidgetItem()
                self.main_fittings.setItem(4, i+1, item)
                item = self.main_fittings.item(4, i+1)
                item.setText(_translate("MainWindow", str(B[i+12])))

        self.B3_11.clicked.connect(fitting_P1)

        # ==
        self.horizontalLayout_16.addWidget(self.B3_11)
        self.B3_12 = QtWidgets.QPushButton(self.tab_11)
        self.B3_12.setObjectName("B3_12")
        # ==
        def save_p1_B():

            print("=============")
            model.db.fitting_coefficients.b = list(self.PumpFit.B)
            # model.db.fitting_coefficients.a = self.PumpFit.A
            # model.db.fitting_coefficients.c = self.PumpFit.C
            # model.db.fitting_coefficients.d = self.PumpFit.D
            # model.db.fitting_coefficients.e = self.PumpFit.E


            # print(model.db.fitting_coefficients.b)
            # print(len(model.db.fitting_coefficients.b))
            # print(model.db.fitting_coefficients.a)
            # print(len(model.db.fitting_coefficients.a))
            # print(model.db.fitting_coefficients.c)
            # print(len(model.db.fitting_coefficients.c))
            # print(model.db.fitting_coefficients.d)
            # print(len(model.db.fitting_coefficients.d))
            # print(model.db.fitting_coefficients.e)
            # print(len(model.db.fitting_coefficients.e))
            #
            #
            #
            #
            save("template.xlsx")

        self.B3_12.clicked.connect(save_p1_B)
        # ==
        self.horizontalLayout_16.addWidget(self.B3_12)
        self.B3_13 = QtWidgets.QPushButton(self.tab_11)
        self.B3_13.setObjectName("B3_13")
        self.horizontalLayout_16.addWidget(self.B3_13)
        self.B3_14 = QtWidgets.QPushButton(self.tab_11)
        self.B3_14.setObjectName("B3_14")
        self.horizontalLayout_16.addWidget(self.B3_14)
        self.verticalLayout_3.addLayout(self.horizontalLayout_16)
        self.horizontalLayout_29.addLayout(self.verticalLayout_3)
        self.tabWidget_2.addTab(self.tab_11, "")
        self.tab_12 = QtWidgets.QWidget()
        self.tab_12.setObjectName("tab_12")
        self.horizontalLayout_5 = QtWidgets.QHBoxLayout(self.tab_12)
        self.horizontalLayout_5.setObjectName("horizontalLayout_5")
        self.verticalLayout_4 = QtWidgets.QVBoxLayout()
        self.verticalLayout_4.setObjectName("verticalLayout_4")
        self.pump2_fittings = QtWidgets.QTableWidget(self.tab_12)
        self.pump2_fittings.setRowCount(25)
        self.pump2_fittings.setColumnCount(20)
        self.pump2_fittings.setObjectName("pump2_fittings")
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(0, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(1, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(1, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(1, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(1, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(1, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(1, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(1, 6, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(1, 7, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(1, 8, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(1, 9, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(1, 10, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(1, 11, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(2, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(2, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(2, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(2, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(2, 6, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(2, 7, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(2, 8, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(2, 9, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(2, 10, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(2, 11, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(3, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(3, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(3, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(3, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(3, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(3, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(3, 6, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(3, 7, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(3, 8, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(3, 9, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(3, 10, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(3, 11, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump2_fittings.setItem(4, 0, item)
        self.pump2_fittings.horizontalHeader().setDefaultSectionSize(200)
        self.verticalLayout_4.addWidget(self.pump2_fittings)
        self.horizontalLayout_6 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_6.setObjectName("horizontalLayout_6")
        self.B3_21 = QtWidgets.QPushButton(self.tab_12)
        self.B3_21.setObjectName("B3_21")
        def fitting_P2():
            _translate = QtCore.QCoreApplication.translate
            print(11)
            # p1_data = model.db.main_fittings
            p2_data = model.db.pump2_fittings
            # for i in p2_data:
            #     print(i.g2)
            #     print(i.p2)
            # p3_data = model.db.pump3_fittings
            # web_data = model.db.wet_bulb_fittings
            # p4_data = model.db.p4_fittings
            # B = self.PumpFit.fit_P1(p1_data)
            A = self.PumpFit.fit_P2(p2_data)
            # C = self.PumpFit.fit_P3(p3_data)
            # D = self.PumpFit.fit_Tdelta(web_data)
            # E = self.PumpFit.fit_P4(p4_data)

            # print(B)
            A0,A1,A2= A

            print(A)

            item = QtWidgets.QTableWidgetItem()
            self.pump2_fittings.setItem(2,1,item)
            item = self.pump2_fittings.item(2,1)
            item.setText(_translate("MainWindow", str(A0)))

            item = QtWidgets.QTableWidgetItem()
            self.pump2_fittings.setItem(2, 2, item)
            item = self.pump2_fittings.item(2, 2)
            item.setText(_translate("MainWindow", str(A1)))

            item = QtWidgets.QTableWidgetItem()
            self.pump2_fittings.setItem(2, 3, item)
            item = self.pump2_fittings.item(2, 3)
            item.setText(_translate("MainWindow", str(A2)))
            item = self.pump2_fittings.item(1, 3)

        self.B3_21.clicked.connect(fitting_P2)

        self.horizontalLayout_6.addWidget(self.B3_21)
        self.B3_22 = QtWidgets.QPushButton(self.tab_12)
        self.B3_22.setObjectName("B3_22")

        def save_p2_A():

            model.db.fitting_coefficients.a = self.PumpFit.A
            save("template.xlsx")

        self.B3_22.clicked.connect(save_p2_A)

        self.horizontalLayout_6.addWidget(self.B3_22)
        self.B3_23 = QtWidgets.QPushButton(self.tab_12)
        self.B3_23.setObjectName("B3_23")
        self.horizontalLayout_6.addWidget(self.B3_23)
        self.B3_24 = QtWidgets.QPushButton(self.tab_12)
        self.B3_24.setObjectName("B3_24")
        self.horizontalLayout_6.addWidget(self.B3_24)
        self.verticalLayout_4.addLayout(self.horizontalLayout_6)
        self.horizontalLayout_5.addLayout(self.verticalLayout_4)
        self.tabWidget_2.addTab(self.tab_12, "")
        self.tab_13 = QtWidgets.QWidget()
        self.tab_13.setObjectName("tab_13")
        self.horizontalLayout_27 = QtWidgets.QHBoxLayout(self.tab_13)
        self.horizontalLayout_27.setObjectName("horizontalLayout_27")
        self.verticalLayout_5 = QtWidgets.QVBoxLayout()
        self.verticalLayout_5.setObjectName("verticalLayout_5")
        self.pump3_fittings = QtWidgets.QTableWidget(self.tab_13)
        self.pump3_fittings.setRowCount(25)
        self.pump3_fittings.setColumnCount(20)
        self.pump3_fittings.setObjectName("pump3_fittings")
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(0, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(1, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(1, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(1, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(1, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(1, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(1, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(1, 6, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(1, 7, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(1, 8, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(1, 9, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(1, 10, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(1, 11, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(2, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(2, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(2, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(2, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(2, 6, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(2, 7, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(2, 8, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(2, 9, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(2, 10, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(2, 11, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(3, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(3, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(3, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(3, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(3, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(3, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(3, 6, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(3, 7, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(3, 8, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(3, 9, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(3, 10, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(3, 11, item)
        item = QtWidgets.QTableWidgetItem()
        self.pump3_fittings.setItem(4, 0, item)
        self.pump3_fittings.horizontalHeader().setDefaultSectionSize(200)
        self.pump3_fittings.horizontalHeader().setMinimumSectionSize(51)
        self.verticalLayout_5.addWidget(self.pump3_fittings)
        self.horizontalLayout_7 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_7.setObjectName("horizontalLayout_7")
        self.B3_31 = QtWidgets.QPushButton(self.tab_13)
        self.B3_31.setObjectName("B3_31")
        def fitting_P3():
            _translate = QtCore.QCoreApplication.translate

            p3_data = model.db.pump3_fittings
            C = self.PumpFit.fit_P3(p3_data)
            # D = self.PumpFit.fit_Tdelta(web_data)
            # E = self.PumpFit.fit_P4(p4_data)

            # print(B)
            C0,C1,C2= C

            print(C)

            item = QtWidgets.QTableWidgetItem()
            self.pump3_fittings.setItem(2,1,item)
            item = self.pump3_fittings.item(2,1)
            item.setText(_translate("MainWindow", str(C0)))

            item = QtWidgets.QTableWidgetItem()
            self.pump3_fittings.setItem(2, 2, item)
            item = self.pump3_fittings.item(2, 2)
            item.setText(_translate("MainWindow", str(C1)))

            item = QtWidgets.QTableWidgetItem()
            self.pump3_fittings.setItem(2, 3, item)
            item = self.pump3_fittings.item(2, 3)
            item.setText(_translate("MainWindow", str(C2)))

        self.B3_31.clicked.connect(fitting_P3)



        self.horizontalLayout_7.addWidget(self.B3_31)
        self.B3_32 = QtWidgets.QPushButton(self.tab_13)
        self.B3_32.setObjectName("B3_32")
        def save_p3_C():

            model.db.fitting_coefficients.c = self.PumpFit.C
            print("此时c：",model.db.fitting_coefficients.c)
            save("template.xlsx")

        self.B3_32.clicked.connect(save_p3_C)

        self.horizontalLayout_7.addWidget(self.B3_32)
        self.B3_33 = QtWidgets.QPushButton(self.tab_13)
        self.B3_33.setObjectName("B3_33")
        self.horizontalLayout_7.addWidget(self.B3_33)
        self.B3_34 = QtWidgets.QPushButton(self.tab_13)
        self.B3_34.setObjectName("B3_34")
        self.horizontalLayout_7.addWidget(self.B3_34)
        self.verticalLayout_5.addLayout(self.horizontalLayout_7)
        self.horizontalLayout_27.addLayout(self.verticalLayout_5)
        self.tabWidget_2.addTab(self.tab_13, "")
        self.tab_14 = QtWidgets.QWidget()
        self.tab_14.setObjectName("tab_14")
        self.horizontalLayout_32 = QtWidgets.QHBoxLayout(self.tab_14)
        self.horizontalLayout_32.setObjectName("horizontalLayout_32")
        self.verticalLayout_6 = QtWidgets.QVBoxLayout()
        self.verticalLayout_6.setObjectName("verticalLayout_6")
        self.wet_bulb_fittings = QtWidgets.QTableWidget(self.tab_14)
        self.wet_bulb_fittings.setRowCount(25)
        self.wet_bulb_fittings.setColumnCount(20)
        self.wet_bulb_fittings.setObjectName("wet_bulb_fittings")
        item = QtWidgets.QTableWidgetItem()
        self.wet_bulb_fittings.setItem(0, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.wet_bulb_fittings.setItem(0, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.wet_bulb_fittings.setItem(1, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.wet_bulb_fittings.setItem(1, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.wet_bulb_fittings.setItem(1, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.wet_bulb_fittings.setItem(1, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.wet_bulb_fittings.setItem(1, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.wet_bulb_fittings.setItem(2, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.wet_bulb_fittings.setItem(2, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.wet_bulb_fittings.setItem(2, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.wet_bulb_fittings.setItem(2, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.wet_bulb_fittings.setItem(3, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.wet_bulb_fittings.setItem(3, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.wet_bulb_fittings.setItem(3, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.wet_bulb_fittings.setItem(3, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.wet_bulb_fittings.setItem(3, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.wet_bulb_fittings.setItem(4, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.wet_bulb_fittings.setItem(4, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.wet_bulb_fittings.setItem(4, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.wet_bulb_fittings.setItem(4, 4, item)
        self.wet_bulb_fittings.horizontalHeader().setCascadingSectionResizes(True)
        self.wet_bulb_fittings.horizontalHeader().setDefaultSectionSize(200)
        self.verticalLayout_6.addWidget(self.wet_bulb_fittings)
        self.horizontalLayout_9 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_9.setObjectName("horizontalLayout_9")
        self.B3_41 = QtWidgets.QPushButton(self.tab_14)
        self.B3_41.setObjectName("B3_41")

        def fitting_wetandp4():
            _translate = QtCore.QCoreApplication.translate
            print(11)
            # p1_data = model.db.main_fittings
            # p2_data = model.db.pump2_fittings
            # for i in p2_data:
            #     print(i.g2)
            #     print(i.p2)
            # p3_data = model.db.pump3_fittings
            web_data = model.db.wet_bulb_fittings
            p4_data = model.db.p4_fittings
            # B = self.PumpFit.fit_P1(p1_data)
            # A = self.PumpFit.fit_P2(p2_data)
            # C = self.PumpFit.fit_P3(p3_data)
            D = self.PumpFit.fit_Tdelta(web_data)
            E = self.PumpFit.fit_P4(p4_data)

            # print(B)
            D0,D1,D2 = D
            E0,E1,E2,E3 = E

            print(D)
            print(E)

            item = QtWidgets.QTableWidgetItem()
            self.wet_bulb_fittings.setItem(2,1,item)
            item = self.wet_bulb_fittings.item(2,1)
            item.setText(_translate("MainWindow", str(D0)))

            item = QtWidgets.QTableWidgetItem()
            self.wet_bulb_fittings.setItem(2, 2, item)
            item = self.wet_bulb_fittings.item(2, 2)
            item.setText(_translate("MainWindow", str(D1)))

            item = QtWidgets.QTableWidgetItem()
            self.wet_bulb_fittings.setItem(2, 3, item)
            item = self.wet_bulb_fittings.item(2, 3)
            item.setText(_translate("MainWindow", str(D2)))

            item = QtWidgets.QTableWidgetItem()
            self.wet_bulb_fittings.setItem(4, 1, item)
            item = self.wet_bulb_fittings.item(4, 1)
            item.setText(_translate("MainWindow", str(E0)))

            item = QtWidgets.QTableWidgetItem()
            self.wet_bulb_fittings.setItem(4, 2, item)
            item = self.wet_bulb_fittings.item(4, 2)
            item.setText(_translate("MainWindow", str(E1)))

            item = QtWidgets.QTableWidgetItem()
            self.wet_bulb_fittings.setItem(4, 3, item)
            item = self.wet_bulb_fittings.item(4, 3)
            item.setText(_translate("MainWindow", str(E2)))

            item = QtWidgets.QTableWidgetItem()
            self.wet_bulb_fittings.setItem(4, 4, item)
            item = self.wet_bulb_fittings.item(4, 4)
            item.setText(_translate("MainWindow", str(E3)))

        self.B3_41.clicked.connect(fitting_wetandp4)

        self.horizontalLayout_9.addWidget(self.B3_41)
        self.B3_42 = QtWidgets.QPushButton(self.tab_14)
        self.B3_42.setObjectName("B3_42")

        def save_wetandp4_DE():

            model.db.fitting_coefficients.d = self.PumpFit.D
            model.db.fitting_coefficients.e = self.PumpFit.E
            save("template.xlsx")

        self.B3_42.clicked.connect(save_wetandp4_DE)

        self.horizontalLayout_9.addWidget(self.B3_42)
        self.B3_43 = QtWidgets.QPushButton(self.tab_14)
        self.B3_43.setObjectName("B3_43")
        self.horizontalLayout_9.addWidget(self.B3_43)
        self.B3_44 = QtWidgets.QPushButton(self.tab_14)
        self.B3_44.setObjectName("B3_44")
        self.horizontalLayout_9.addWidget(self.B3_44)
        self.verticalLayout_6.addLayout(self.horizontalLayout_9)
        self.horizontalLayout_32.addLayout(self.verticalLayout_6)
        self.tabWidget_2.addTab(self.tab_14, "")
        self.horizontalLayout_12.addWidget(self.tabWidget_2)
        self.stackedWidget.addWidget(self.page_3)
        self.page_4 = QtWidgets.QWidget()
        self.page_4.setObjectName("page_4")
        self.layoutWidget = QtWidgets.QWidget(self.page_4)
        self.layoutWidget.setGeometry(QtCore.QRect(11, 11, 951, 701))
        self.layoutWidget.setObjectName("layoutWidget")
        self.verticalLayout_7 = QtWidgets.QVBoxLayout(self.layoutWidget)
        self.verticalLayout_7.setContentsMargins(0, 0, 0, 0)
        self.verticalLayout_7.setObjectName("verticalLayout_7")
        self.optimize_result = QtWidgets.QTableWidget(self.layoutWidget)
        font = QtGui.QFont()
        font.setPointSize(12)
        font.setStrikeOut(False)
        self.optimize_result.setFont(font)
        self.optimize_result.setRowCount(25)
        self.optimize_result.setColumnCount(20)
        self.optimize_result.setObjectName("optimize_result")
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(0, 0, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(0, 1, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(0, 2, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(0, 3, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(0, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(0, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(0, 6, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(0, 7, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(0, 8, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(0, 9, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(0, 10, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(0, 11, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(0, 12, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(0, 13, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(0, 14, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(0, 15, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(0, 16, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(0, 17, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(0, 18, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(0, 19, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(1, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(1, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(2, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(2, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(3, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(3, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(4, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(4, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(5, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(5, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(6, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(6, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(7, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(7, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(8, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(8, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(9, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(9, 5, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(10, 4, item)
        item = QtWidgets.QTableWidgetItem()
        self.optimize_result.setItem(10, 5, item)
        self.verticalLayout_7.addWidget(self.optimize_result)
        self.horizontalLayout_18 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_18.setObjectName("horizontalLayout_18")
        spacerItem7 = QtWidgets.QSpacerItem(40, 20, QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Minimum)
        self.horizontalLayout_18.addItem(spacerItem7)
        self.pushButton_4 = QtWidgets.QPushButton(self.layoutWidget)
        self.pushButton_4.setObjectName("pushButton_4")
        def evo_opt():
            _translate = QtCore.QCoreApplication.translate

            superP = model.db.init_params
            for index,i in enumerate(model.db.optimize_result):

                Q = i.q
                TS = i.ts
                print("Q:",Q)
                print("TS:",TS)

                opt = Main.Evoopt(Q,TS,superP,self.PumpFit)
                res = opt.run()
                model.db.optimize_result[index].load_percentage = res[0]
                model.db.optimize_result[index].t1 = res[1]
                model.db.optimize_result[index].t2 = res[2]
                model.db.optimize_result[index].t3 = res[3]
                model.db.optimize_result[index].t4 = res[4]
                model.db.optimize_result[index].delta_t = res[5]
                model.db.optimize_result[index].p1 = res[6]
                model.db.optimize_result[index].p2 = res[7]
                model.db.optimize_result[index].p3 = res[8]
                model.db.optimize_result[index].p4 = res[9]
                model.db.optimize_result[index].p = res[10]
                model.db.optimize_result[index].cop = res[11]
                model.db.optimize_result[index].n = res[12]
                # res = (loading_ration, T1, T2, T3, T4, cold_flu, P1, P2, P3, P4, total_P, total_cop, open_num)

                for k in range(len(res)):
                    item = QtWidgets.QTableWidgetItem()
                    # print(index+1, 7+k)
                    self.optimize_result.setItem(index+1, 7+k, item)
                    item = self.optimize_result.item(index+1, 7+k)
                    item.setText(_translate("MainWindow", str(res[k])))

        self.pushButton_4.clicked.connect(evo_opt)


        self.horizontalLayout_18.addWidget(self.pushButton_4)
        self.pushButton_3 = QtWidgets.QPushButton(self.layoutWidget)
        self.pushButton_3.setObjectName("pushButton_3")
        def save_opt_res():
            print(222)
            save("template.xlsx")
        self.pushButton_3.clicked.connect(save_opt_res)


        self.horizontalLayout_18.addWidget(self.pushButton_3)
        self.pushButton_2 = QtWidgets.QPushButton(self.layoutWidget)
        self.pushButton_2.setObjectName("pushButton_2")
        self.horizontalLayout_18.addWidget(self.pushButton_2)
        self.verticalLayout_7.addLayout(self.horizontalLayout_18)
        self.stackedWidget.addWidget(self.page_4)
        self.verticalLayout_2.addWidget(self.stackedWidget)
        MainWindow.setCentralWidget(self.centralwidget)
        self.dockWidget = QtWidgets.QDockWidget(MainWindow)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Preferred, QtWidgets.QSizePolicy.Preferred)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.dockWidget.sizePolicy().hasHeightForWidth())
        self.dockWidget.setSizePolicy(sizePolicy)
        self.dockWidget.setObjectName("dockWidget")
        self.dockWidgetContents = QtWidgets.QWidget()
        self.dockWidgetContents.setObjectName("dockWidgetContents")
        self.horizontalLayout_4 = QtWidgets.QHBoxLayout(self.dockWidgetContents)
        self.horizontalLayout_4.setObjectName("horizontalLayout_4")
        self.toolBox = QtWidgets.QToolBox(self.dockWidgetContents)
        font = QtGui.QFont()
        font.setPointSize(15)
        font.setUnderline(False)
        self.toolBox.setFont(font)
        self.toolBox.setLineWidth(0)
        self.toolBox.setObjectName("toolBox")
        self.page_5 = QtWidgets.QWidget()
        self.page_5.setGeometry(QtCore.QRect(0, 0, 183, 546))
        self.page_5.setObjectName("page_5")
        self.toolBox.addItem(self.page_5, "")
        self.page_6 = QtWidgets.QWidget()
        self.page_6.setGeometry(QtCore.QRect(0, 0, 183, 546))
        self.page_6.setObjectName("page_6")
        self.toolBox.addItem(self.page_6, "")
        self.page_7 = QtWidgets.QWidget()
        self.page_7.setGeometry(QtCore.QRect(0, 0, 183, 546))
        self.page_7.setObjectName("page_7")
        self.toolBox.addItem(self.page_7, "")
        self.page_8 = QtWidgets.QWidget()
        self.page_8.setGeometry(QtCore.QRect(0, 0, 183, 546))
        self.page_8.setObjectName("page_8")
        self.toolBox.addItem(self.page_8, "")
        self.horizontalLayout_4.addWidget(self.toolBox)
        self.dockWidget.setWidget(self.dockWidgetContents)
        MainWindow.addDockWidget(QtCore.Qt.DockWidgetArea(1), self.dockWidget)

        self.retranslateUi(MainWindow)
        self.stackedWidget.setCurrentIndex(0)
        self.tabWidget.setCurrentIndex(0)
        self.tabWidget_2.setCurrentIndex(0)
        self.toolBox.setCurrentIndex(0)
        self.pushButton.clicked.connect(self.init_params.clearContents)
        self.pushButton_41.clicked.connect(self.table_25.clearContents)
        self.pushButton_53.clicked.connect(self.table_21.clearContents)
        self.pushButton_51.clicked.connect(self.table_22.clearContents)
        self.pushButton_49.clicked.connect(self.table_23.clearContents)
        self.pushButton_47.clicked.connect(self.table_24.clearContents)
        self.toolBox.currentChanged['int'].connect(self.stackedWidget.setCurrentIndex)
        self.pushButton_2.clicked.connect(self.optimize_result.clearContents)
        self.B3_24.clicked.connect(self.pump2_fittings.clearContents)
        self.B3_44.clicked.connect(self.wet_bulb_fittings.clearContents)
        self.B3_14.clicked.connect(self.main_fittings.clearContents)
        self.B3_34.clicked.connect(self.pump3_fittings.clearContents)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)

    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        MainWindow.setWindowTitle(_translate("MainWindow", "MainWindow"))
        self.label.setText(_translate("MainWindow", "计算类型设置"))
        self.comboBox.setItemText(0, _translate("MainWindow", "单冷型"))
        self.comboBox.setItemText(1, _translate("MainWindow", "冷暖型"))
        self.label_2.setText(_translate("MainWindow", "冷源类型"))
        self.comboBox_2.setItemText(0, _translate("MainWindow", "冷水机组+冷却塔"))
        self.comboBox_2.setItemText(1, _translate("MainWindow", "风冷热泵机组"))
        self.comboBox_2.setItemText(2, _translate("MainWindow", "一体化蒸发冷水机组"))
        self.label_3.setText(_translate("MainWindow", "热源类型"))
        self.comboBox_3.setItemText(0, _translate("MainWindow", "锅炉"))
        self.comboBox_3.setItemText(1, _translate("MainWindow", "风冷热泵机组"))
        __sortingEnabled = self.init_params.isSortingEnabled()
        self.init_params.setSortingEnabled(False)
        item = self.init_params.item(0, 0)
        item.setText(_translate("MainWindow", "负荷率，%"))
        item = self.init_params.item(0, 1)
        item.setText(_translate("MainWindow", "100%"))
        item = self.init_params.item(0, 2)
        item.setText(_translate("MainWindow", "95%"))
        item = self.init_params.item(0, 3)
        item.setText(_translate("MainWindow", "90%"))
        item = self.init_params.item(0, 4)
        item.setText(_translate("MainWindow", "85%"))
        item = self.init_params.item(0, 5)
        item.setText(_translate("MainWindow", "80%"))
        item = self.init_params.item(0, 6)
        item.setText(_translate("MainWindow", "75%"))
        item = self.init_params.item(0, 7)
        item.setText(_translate("MainWindow", "70%"))
        item = self.init_params.item(0, 8)
        item.setText(_translate("MainWindow", "65%"))
        item = self.init_params.item(0, 9)
        item.setText(_translate("MainWindow", "60%及以下"))
        item = self.init_params.item(1, 0)
        item.setText(_translate("MainWindow", "冷冻水出水温度：T1"))
        item = self.init_params.item(1, 1)
        item.setText(_translate("MainWindow", "7"))
        item = self.init_params.item(1, 2)
        item.setText(_translate("MainWindow", "7.5"))
        item = self.init_params.item(1, 3)
        item.setText(_translate("MainWindow", "8"))
        item = self.init_params.item(1, 4)
        item.setText(_translate("MainWindow", "8.5"))
        item = self.init_params.item(1, 5)
        item.setText(_translate("MainWindow", "9"))
        item = self.init_params.item(1, 6)
        item.setText(_translate("MainWindow", "9.5"))
        item = self.init_params.item(1, 7)
        item.setText(_translate("MainWindow", "10"))
        item = self.init_params.item(1, 8)
        item.setText(_translate("MainWindow", "10"))
        item = self.init_params.item(1, 9)
        item.setText(_translate("MainWindow", "10"))
        item = self.init_params.item(2, 0)
        item.setText(_translate("MainWindow", "冷水机组设定"))
        item = self.init_params.item(3, 0)
        item.setText(_translate("MainWindow", "单台额定冷水机组额定负荷Qs，KW"))




        self.init_params.setSortingEnabled(__sortingEnabled)
        self.B1_1.setText(_translate("MainWindow", "保存"))
        self.pushButton.setText(_translate("MainWindow", "取消"))
        self.B2_1.setText(_translate("MainWindow", "读入"))
        self.pushButton_53.setText(_translate("MainWindow", "取消"))
        __sortingEnabled = self.table_21.isSortingEnabled()
        self.table_21.setSortingEnabled(False)
        item = self.table_21.item(0, 0)
        item.setText(_translate("MainWindow", "负荷百分比"))
        item = self.table_21.item(0, 1)
        item.setText(_translate("MainWindow", "Q"))
        item = self.table_21.item(0, 2)
        item.setText(_translate("MainWindow", "功率百分比"))
        item = self.table_21.item(0, 3)
        item.setText(_translate("MainWindow", "P1"))
        item = self.table_21.item(0, 4)
        item.setText(_translate("MainWindow", "T1"))
        item = self.table_21.item(0, 5)
        item.setText(_translate("MainWindow", "T2"))
        item = self.table_21.item(0, 6)
        item.setText(_translate("MainWindow", "T3"))
        item = self.table_21.item(0, 7)
        item.setText(_translate("MainWindow", "T4"))
        item = self.table_21.item(0, 8)
        item.setText(_translate("MainWindow", "COP.R"))
        item = self.table_21.item(1, 0)
        item.setText(_translate("MainWindow", "%"))
        item = self.table_21.item(1, 1)
        item.setText(_translate("MainWindow", "(kW)"))
        item = self.table_21.item(1, 2)
        item.setText(_translate("MainWindow", "%"))
        item = self.table_21.item(1, 3)
        item.setText(_translate("MainWindow", "(kW)"))
        item = self.table_21.item(1, 4)
        item.setText(_translate("MainWindow", "℃"))
        item = self.table_21.item(1, 5)
        item.setText(_translate("MainWindow", "℃"))
        item = self.table_21.item(1, 6)
        item.setText(_translate("MainWindow", "℃"))
        item = self.table_21.item(1, 7)
        item.setText(_translate("MainWindow", "℃"))



        self.table_21.setSortingEnabled(__sortingEnabled)






        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab_6), _translate("MainWindow", "主机设备"))
        self.B2_2.setText(_translate("MainWindow", "读入"))
        self.pushButton_51.setText(_translate("MainWindow", "取消"))
        __sortingEnabled = self.table_22.isSortingEnabled()
        self.table_22.setSortingEnabled(False)
        item = self.table_22.item(0, 0)
        item.setText(_translate("MainWindow", "序号"))
        item = self.table_22.item(0, 1)
        item.setText(_translate("MainWindow", "型号"))
        item = self.table_22.item(0, 2)
        item.setText(_translate("MainWindow", "G2"))
        item = self.table_22.item(0, 3)
        item.setText(_translate("MainWindow", "P2"))
        item = self.table_22.item(0, 4)
        item.setText(_translate("MainWindow", "G2"))
        item = self.table_22.item(0, 5)
        item.setText(_translate("MainWindow", "P2"))
        item = self.table_22.item(0, 6)
        item.setText(_translate("MainWindow", "G2"))
        item = self.table_22.item(0, 7)
        item.setText(_translate("MainWindow", "P2"))
        item = self.table_22.item(0, 8)
        item.setText(_translate("MainWindow", "G2"))
        item = self.table_22.item(0, 9)
        item.setText(_translate("MainWindow", "P2"))
        item = self.table_22.item(0, 10)
        item.setText(_translate("MainWindow", "G2"))
        item = self.table_22.item(0, 11)
        item.setText(_translate("MainWindow", "P2"))
        item = self.table_22.item(1, 2)
        item.setText(_translate("MainWindow", "流量（m3/h)"))
        item = self.table_22.item(1, 3)
        item.setText(_translate("MainWindow", "轴功率(kw)"))
        item = self.table_22.item(1, 4)
        item.setText(_translate("MainWindow", "流量（m3/h)"))
        item = self.table_22.item(1, 5)
        item.setText(_translate("MainWindow", "轴功率(kw)"))
        item = self.table_22.item(1, 6)
        item.setText(_translate("MainWindow", "流量（m3/h)"))
        item = self.table_22.item(1, 7)
        item.setText(_translate("MainWindow", "轴功率(kw)"))
        item = self.table_22.item(1, 8)
        item.setText(_translate("MainWindow", "流量（m3/h)"))
        item = self.table_22.item(1, 9)
        item.setText(_translate("MainWindow", "轴功率(kw)"))
        item = self.table_22.item(1, 10)
        item.setText(_translate("MainWindow", "流量（m3/h)"))
        item = self.table_22.item(1, 11)
        item.setText(_translate("MainWindow", "轴功率(kw)"))








        self.table_22.setSortingEnabled(__sortingEnabled)
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab_7), _translate("MainWindow", "冷冻水泵"))
        self.B2_3.setText(_translate("MainWindow", "读入"))
        self.pushButton_49.setText(_translate("MainWindow", "取消"))
        __sortingEnabled = self.table_23.isSortingEnabled()
        self.table_23.setSortingEnabled(False)
        item = self.table_23.item(0, 0)
        item.setText(_translate("MainWindow", "序号"))
        item = self.table_23.item(0, 1)
        item.setText(_translate("MainWindow", "型号"))
        item = self.table_23.item(0, 2)
        item.setText(_translate("MainWindow", "G3"))
        item = self.table_23.item(0, 3)
        item.setText(_translate("MainWindow", "P3"))
        item = self.table_23.item(0, 4)
        item.setText(_translate("MainWindow", "G3"))
        item = self.table_23.item(0, 5)
        item.setText(_translate("MainWindow", "P3"))
        item = self.table_23.item(0, 6)
        item.setText(_translate("MainWindow", "G3"))
        item = self.table_23.item(0, 7)
        item.setText(_translate("MainWindow", "P3"))
        item = self.table_23.item(0, 8)
        item.setText(_translate("MainWindow", "G3"))
        item = self.table_23.item(0, 9)
        item.setText(_translate("MainWindow", "P3"))
        item = self.table_23.item(0, 10)
        item.setText(_translate("MainWindow", "G3"))
        item = self.table_23.item(0, 11)
        item.setText(_translate("MainWindow", "P3"))
        item = self.table_23.item(1, 2)
        item.setText(_translate("MainWindow", "流量（m3/h)"))
        item = self.table_23.item(1, 3)
        item.setText(_translate("MainWindow", "轴功率(kw)"))
        item = self.table_23.item(1, 4)
        item.setText(_translate("MainWindow", "流量（m3/h)"))
        item = self.table_23.item(1, 5)
        item.setText(_translate("MainWindow", "轴功率(kw)"))
        item = self.table_23.item(1, 6)
        item.setText(_translate("MainWindow", "流量（m3/h)"))
        item = self.table_23.item(1, 7)
        item.setText(_translate("MainWindow", "轴功率(kw)"))
        item = self.table_23.item(1, 8)
        item.setText(_translate("MainWindow", "流量（m3/h)"))
        item = self.table_23.item(1, 9)
        item.setText(_translate("MainWindow", "轴功率(kw)"))
        item = self.table_23.item(1, 10)
        item.setText(_translate("MainWindow", "流量（m3/h)"))
        item = self.table_23.item(1, 11)
        item.setText(_translate("MainWindow", "轴功率(kw)"))





        self.table_23.setSortingEnabled(__sortingEnabled)
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab_8), _translate("MainWindow", "冷却水泵"))
        self.B2_4.setText(_translate("MainWindow", "读入"))
        self.pushButton_47.setText(_translate("MainWindow", "取消"))
        __sortingEnabled = self.table_24.isSortingEnabled()
        self.table_24.setSortingEnabled(False)
        item = self.table_24.item(0, 0)
        item.setText(_translate("MainWindow", "湿球温度"))
        item = self.table_24.item(0, 1)
        item.setText(_translate("MainWindow", "冷幅T3-Ts"))
        item = self.table_24.item(0, 2)
        item.setText(_translate("MainWindow", "进水温度"))
        item = self.table_24.item(0, 3)
        item.setText(_translate("MainWindow", "出水温度"))
        item = self.table_24.item(0, 4)
        item.setText(_translate("MainWindow", "水流量（m3/h）"))
        item = self.table_24.item(0, 5)
        item.setText(_translate("MainWindow", "空气流量（m3/h）"))
        item = self.table_24.item(0, 6)
        item.setText(_translate("MainWindow", "功率（Kw）P0"))
        item = self.table_24.item(34, 0)
        item.setText(_translate("MainWindow", "湿球温度"))
        item = self.table_24.item(34, 1)
        item.setText(_translate("MainWindow", "冷幅"))
        item = self.table_24.item(34, 2)
        item.setText(_translate("MainWindow", "进水温度"))
        item = self.table_24.item(34, 3)
        item.setText(_translate("MainWindow", "出水温度"))
        item = self.table_24.item(34, 4)
        item.setText(_translate("MainWindow", "水流量G（m3/h）"))
        item = self.table_24.item(34, 5)
        item.setText(_translate("MainWindow", "功率P4（Kw）"))
        item = self.table_24.item(34, 6)
        item.setText(_translate("MainWindow", "空气流量（m3/h）"))
        self.table_24.setSortingEnabled(__sortingEnabled)
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab_9), _translate("MainWindow", "冷却塔"))
        self.B2_5.setText(_translate("MainWindow", "读入"))
        self.pushButton_41.setText(_translate("MainWindow", "取消"))
        __sortingEnabled = self.table_25.isSortingEnabled()









        self.table_25.setSortingEnabled(False)
        item = self.table_25.item(0, 0)
        item.setText(_translate("MainWindow", "年"))
        item = self.table_25.item(0, 1)
        item.setText(_translate("MainWindow", "月"))
        item = self.table_25.item(0, 2)
        item.setText(_translate("MainWindow", "日"))
        item = self.table_25.item(0, 3)
        item.setText(_translate("MainWindow", "时"))
        item = self.table_25.item(0, 4)
        item.setText(_translate("MainWindow", "负荷Q，Kw"))
        item = self.table_25.item(0, 5)
        item.setText(_translate("MainWindow", "湿球温度Ts,℃"))
        item = self.table_25.item(0, 6)
        item.setText(_translate("MainWindow", "干球温度T,℃"))
        self.table_25.setSortingEnabled(__sortingEnabled)
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab_10), _translate("MainWindow", "负荷/室外干球温度、室外湿球温度"))
        __sortingEnabled = self.main_fittings.isSortingEnabled()
        self.main_fittings.setSortingEnabled(False)
        item = self.main_fittings.item(0, 0)
        item.setText(_translate("MainWindow", "主机系数拟合"))
        item = self.main_fittings.item(1, 0)
        item.setText(_translate("MainWindow", "系数"))
        item = self.main_fittings.item(1, 1)
        item.setText(_translate("MainWindow", "B0"))
        item = self.main_fittings.item(1, 2)
        item.setText(_translate("MainWindow", "B1"))
        item = self.main_fittings.item(1, 3)
        item.setText(_translate("MainWindow", "B2"))
        item = self.main_fittings.item(1, 4)
        item.setText(_translate("MainWindow", "B3"))
        item = self.main_fittings.item(1, 5)
        item.setText(_translate("MainWindow", "B4"))
        item = self.main_fittings.item(1, 6)
        item.setText(_translate("MainWindow", "B5"))
        item = self.main_fittings.item(1, 7)
        item.setText(_translate("MainWindow", "B6"))
        item = self.main_fittings.item(1, 8)
        item.setText(_translate("MainWindow", "B7"))
        item = self.main_fittings.item(1, 9)
        item.setText(_translate("MainWindow", "B8"))
        item = self.main_fittings.item(1, 10)
        item.setText(_translate("MainWindow", "B9"))
        item = self.main_fittings.item(1, 11)
        item.setText(_translate("MainWindow", "B10"))
        item = self.main_fittings.item(1, 12)
        item.setText(_translate("MainWindow", "B11"))
        item = self.main_fittings.item(3, 1)
        item.setText(_translate("MainWindow", "B12"))
        item = self.main_fittings.item(3, 2)
        item.setText(_translate("MainWindow", "B13"))
        item = self.main_fittings.item(3, 3)
        item.setText(_translate("MainWindow", "B14"))
        item = self.main_fittings.item(3, 4)
        item.setText(_translate("MainWindow", "B15"))
        item = self.main_fittings.item(3, 5)
        item.setText(_translate("MainWindow", "B16"))
        item = self.main_fittings.item(3, 6)
        item.setText(_translate("MainWindow", "B17"))
        item = self.main_fittings.item(3, 7)
        item.setText(_translate("MainWindow", "B18"))
        item = self.main_fittings.item(3, 8)
        item.setText(_translate("MainWindow", "B19"))
        item = self.main_fittings.item(3, 9)
        item.setText(_translate("MainWindow", "B20"))
        item = self.main_fittings.item(3, 10)
        item.setText(_translate("MainWindow", "B21"))
        item = self.main_fittings.item(3, 11)
        item.setText(_translate("MainWindow", "B22"))
        item = self.main_fittings.item(3, 12)
        item.setText(_translate("MainWindow", "B23"))
        self.main_fittings.setSortingEnabled(__sortingEnabled)
        self.B3_11.setText(_translate("MainWindow", "拟合"))
        self.B3_12.setText(_translate("MainWindow", "保存"))
        self.B3_13.setText(_translate("MainWindow", "重新载入数据"))
        self.B3_14.setText(_translate("MainWindow", "取消"))
        self.tabWidget_2.setTabText(self.tabWidget_2.indexOf(self.tab_11), _translate("MainWindow", "主机设备系数"))
        __sortingEnabled = self.pump2_fittings.isSortingEnabled()
        self.pump2_fittings.setSortingEnabled(False)
        item = self.pump2_fittings.item(0, 0)
        item.setText(_translate("MainWindow", "冷冻泵系数拟合"))
        item = self.pump2_fittings.item(1, 0)
        item.setText(_translate("MainWindow", "系数"))
        item = self.pump2_fittings.item(1, 1)
        item.setText(_translate("MainWindow", "A0"))
        item = self.pump2_fittings.item(1, 2)
        item.setText(_translate("MainWindow", "A1"))
        item = self.pump2_fittings.item(1, 3)
        item.setText(_translate("MainWindow", "A2"))
        self.pump2_fittings.setSortingEnabled(__sortingEnabled)
        self.B3_21.setText(_translate("MainWindow", "拟合"))
        self.B3_22.setText(_translate("MainWindow", "保存"))
        self.B3_23.setText(_translate("MainWindow", "重新载入数据"))
        self.B3_24.setText(_translate("MainWindow", "取消"))
        self.tabWidget_2.setTabText(self.tabWidget_2.indexOf(self.tab_12), _translate("MainWindow", "冷冻水泵系数"))
        __sortingEnabled = self.pump3_fittings.isSortingEnabled()
        self.pump3_fittings.setSortingEnabled(False)
        item = self.pump3_fittings.item(0, 0)
        item.setText(_translate("MainWindow", "冷却泵系数拟合"))
        item = self.pump3_fittings.item(1, 0)
        item.setText(_translate("MainWindow", "系数"))
        item = self.pump3_fittings.item(1, 1)
        item.setText(_translate("MainWindow", "C0"))
        item = self.pump3_fittings.item(1, 2)
        item.setText(_translate("MainWindow", "C1"))
        item = self.pump3_fittings.item(1, 3)
        item.setText(_translate("MainWindow", "C2"))
        self.pump3_fittings.setSortingEnabled(__sortingEnabled)
        self.B3_31.setText(_translate("MainWindow", "拟合"))
        self.B3_32.setText(_translate("MainWindow", "保存"))
        self.B3_33.setText(_translate("MainWindow", "重新载入数据"))
        self.B3_34.setText(_translate("MainWindow", "取消"))
        self.tabWidget_2.setTabText(self.tabWidget_2.indexOf(self.tab_13), _translate("MainWindow", "冷却水泵系数"))
        __sortingEnabled = self.wet_bulb_fittings.isSortingEnabled()
        self.wet_bulb_fittings.setSortingEnabled(False)
        item = self.wet_bulb_fittings.item(0, 0)
        item.setText(_translate("MainWindow", "冷却塔系数拟合"))
        item = self.wet_bulb_fittings.item(1, 0)
        item.setText(_translate("MainWindow", "系数（冷幅)"))
        item = self.wet_bulb_fittings.item(1, 1)
        item.setText(_translate("MainWindow", "D0"))
        item = self.wet_bulb_fittings.item(1, 2)
        item.setText(_translate("MainWindow", "D1"))
        item = self.wet_bulb_fittings.item(1, 3)
        item.setText(_translate("MainWindow", "D2"))
        item = self.wet_bulb_fittings.item(3, 0)
        item.setText(_translate("MainWindow", "系数(功率)"))
        item = self.wet_bulb_fittings.item(3, 1)
        item.setText(_translate("MainWindow", "E0"))
        item = self.wet_bulb_fittings.item(3, 2)
        item.setText(_translate("MainWindow", "E1"))
        item = self.wet_bulb_fittings.item(3, 3)
        item.setText(_translate("MainWindow", "E2"))
        item = self.wet_bulb_fittings.item(3, 4)
        item.setText(_translate("MainWindow", "E3"))
        self.wet_bulb_fittings.setSortingEnabled(__sortingEnabled)
        self.B3_41.setText(_translate("MainWindow", "拟合"))
        self.B3_42.setText(_translate("MainWindow", "保存"))
        self.B3_43.setText(_translate("MainWindow", "重新载入数据"))
        self.B3_44.setText(_translate("MainWindow", "取消"))
        self.tabWidget_2.setTabText(self.tabWidget_2.indexOf(self.tab_14), _translate("MainWindow", "冷却塔系数"))
        __sortingEnabled = self.optimize_result.isSortingEnabled()
        self.optimize_result.setSortingEnabled(False)
        item = self.optimize_result.item(0, 0)
        item.setText(_translate("MainWindow", "年"))
        item = self.optimize_result.item(0, 1)
        item.setText(_translate("MainWindow", "月"))
        item = self.optimize_result.item(0, 2)
        item.setText(_translate("MainWindow", "日"))
        item = self.optimize_result.item(0, 3)
        item.setText(_translate("MainWindow", "时"))
        item = self.optimize_result.item(0, 4)
        item.setText(_translate("MainWindow", "负荷Q/Kw"))
        item = self.optimize_result.item(0, 5)
        item.setText(_translate("MainWindow", "湿球温度Ts/℃"))
        item = self.optimize_result.item(0, 6)
        item.setText(_translate("MainWindow", "干球温度T/℃"))
        item = self.optimize_result.item(0, 7)
        item.setText(_translate("MainWindow", "负荷百分比/%"))
        item = self.optimize_result.item(0, 8)
        item.setText(_translate("MainWindow", "冷冻水出水温度/℃"))
        item = self.optimize_result.item(0, 9)
        item.setText(_translate("MainWindow", "冷冻水回水温度/℃"))
        item = self.optimize_result.item(0, 10)
        item.setText(_translate("MainWindow", "冷却水出水温度/℃"))
        item = self.optimize_result.item(0, 11)
        item.setText(_translate("MainWindow", "冷却水回水温度/℃"))
        item = self.optimize_result.item(0, 12)
        item.setText(_translate("MainWindow", "冷却塔冷幅/℃"))
        item = self.optimize_result.item(0, 13)
        item.setText(_translate("MainWindow", "主机功率/Kw"))
        item = self.optimize_result.item(0, 14)
        item.setText(_translate("MainWindow", "冷冻水泵功率/Kw"))
        item = self.optimize_result.item(0, 15)
        item.setText(_translate("MainWindow", "冷却水泵功率/Kw"))
        item = self.optimize_result.item(0, 16)
        item.setText(_translate("MainWindow", "冷却塔功率/Kw"))
        item = self.optimize_result.item(0, 17)
        item.setText(_translate("MainWindow", "总功率/Kw"))
        item = self.optimize_result.item(0, 18)
        item.setText(_translate("MainWindow", "系统COP"))
        item = self.optimize_result.item(0, 19)
        item.setText(_translate("MainWindow", "设备开启台数/台"))
        item = self.optimize_result.item(1, 4)
        item.setText(_translate("MainWindow", "2814"))
        item = self.optimize_result.item(1, 5)
        item.setText(_translate("MainWindow", "28"))
        item = self.optimize_result.item(2, 4)
        item.setText(_translate("MainWindow", "2532.6"))
        item = self.optimize_result.item(2, 5)
        item.setText(_translate("MainWindow", "27"))
        item = self.optimize_result.item(3, 4)
        item.setText(_translate("MainWindow", "2251.2"))
        item = self.optimize_result.item(3, 5)
        item.setText(_translate("MainWindow", "26"))
        item = self.optimize_result.item(4, 4)
        item.setText(_translate("MainWindow", "1969.8"))
        item = self.optimize_result.item(4, 5)
        item.setText(_translate("MainWindow", "25"))
        item = self.optimize_result.item(5, 4)
        item.setText(_translate("MainWindow", "1688.4"))
        item = self.optimize_result.item(5, 5)
        item.setText(_translate("MainWindow", "24"))
        item = self.optimize_result.item(6, 4)
        item.setText(_translate("MainWindow", "1407"))
        item = self.optimize_result.item(6, 5)
        item.setText(_translate("MainWindow", "23"))
        item = self.optimize_result.item(7, 4)
        item.setText(_translate("MainWindow", "1125.6"))
        item = self.optimize_result.item(7, 5)
        item.setText(_translate("MainWindow", "22"))
        item = self.optimize_result.item(8, 4)
        item.setText(_translate("MainWindow", "844.2"))
        item = self.optimize_result.item(8, 5)
        item.setText(_translate("MainWindow", "20"))
        item = self.optimize_result.item(9, 4)
        item.setText(_translate("MainWindow", "562.8"))
        item = self.optimize_result.item(9, 5)
        item.setText(_translate("MainWindow", "18"))
        item = self.optimize_result.item(10, 4)
        item.setText(_translate("MainWindow", "281.4"))
        item = self.optimize_result.item(10, 5)
        item.setText(_translate("MainWindow", "16"))
        self.optimize_result.setSortingEnabled(__sortingEnabled)
        self.pushButton_4.setText(_translate("MainWindow", "优化计算"))
        self.pushButton_3.setText(_translate("MainWindow", "保存"))
        self.pushButton_2.setText(_translate("MainWindow", "取消"))
        self.toolBox.setItemText(self.toolBox.indexOf(self.page_5), _translate("MainWindow", "初始化参数编辑"))
        self.toolBox.setItemText(self.toolBox.indexOf(self.page_6), _translate("MainWindow", "数据读入"))
        self.toolBox.setItemText(self.toolBox.indexOf(self.page_7), _translate("MainWindow", "数据拟合"))
        self.toolBox.setItemText(self.toolBox.indexOf(self.page_8), _translate("MainWindow", "优化计算"))

        self.init_params.setRowCount(28)
        # 初始参数设置 数据填充
        item = self.init_params.item(3, 1)
        item.setText(_translate("MainWindow", str(model.db.init_params.q)))
        item = self.init_params.item(4, 0)
        item.setText(_translate("MainWindow", "冷水机组最多台数,台"))
        item = self.init_params.item(4, 1)
        item.setText(_translate("MainWindow", str(model.db.init_params.n)))
        item = self.init_params.item(5, 0)
        item.setText(_translate("MainWindow", "单台高效率冷负荷范围η，%"))
        item = self.init_params.item(5, 1)
        item.setText(_translate("MainWindow", str(model.db.init_params.efficiency_range)))
        item = self.init_params.item(6, 0)
        item.setText(_translate("MainWindow", "单台冷水机组最低负荷Qq,Kw"))
        item = self.init_params.item(6, 1)
        item.setText(_translate("MainWindow", str(model.db.init_params.q_min)))
        item = self.init_params.item(7, 0)
        item.setText(_translate("MainWindow", "冷却塔出水（机组允许）最低温度T3"))
        item = self.init_params.item(7, 1)
        item.setText(_translate("MainWindow", str(model.db.init_params.t3_min)))
        item = self.init_params.item(8, 0)
        item.setText(_translate("MainWindow", "冷冻水泵设定"))
        item = self.init_params.item(9, 0)
        item.setText(_translate("MainWindow", "单台冷冻水泵的额定流量G20，m3/h"))
        item = self.init_params.item(9, 1)
        item.setText(_translate("MainWindow", str(model.db.init_params.G20)))
        item = self.init_params.item(10, 0)
        item.setText(_translate("MainWindow", "单台冷冻水泵扬程H，m"))
        item = self.init_params.item(10, 1)
        item.setText(_translate("MainWindow", str(model.db.init_params.h)))
        item = self.init_params.item(11, 0)
        item.setText(_translate("MainWindow", "单台冷冻水泵功率P2，Kw"))
        item = self.init_params.item(11, 1)
        item.setText(_translate("MainWindow", str(model.db.init_params.p2)))
        item = self.init_params.item(12, 0)
        item.setText(_translate("MainWindow", "冷冻水泵台数,台"))
        item = self.init_params.item(12, 1)
        item.setText(_translate("MainWindow", str(model.db.init_params.n)))
        item = self.init_params.item(13, 0)
        item.setText(_translate("MainWindow", "冷冻水泵变频频率下限值μ"))
        item = self.init_params.item(13, 1)
        item.setText(_translate("MainWindow", str(model.db.init_params.mu)))



        item = self.init_params.item(14, 0)
        item.setText(_translate("MainWindow", "冷却水泵设定"))
        item = self.init_params.item(15, 0)
        item.setText(_translate("MainWindow", "单台冷却水泵的额定流量G30，m3/h"))
        item = self.init_params.item(15, 1)
        item.setText(_translate("MainWindow",  str(model.db.init_params.G30)))
        item = self.init_params.item(16, 0)
        item.setText(_translate("MainWindow", "单台冷却水泵扬程H，m"))
        item = self.init_params.item(16, 1)
        item.setText(_translate("MainWindow", ""))
        item = self.init_params.item(17, 0)
        item.setText(_translate("MainWindow", "单台冷却水泵功率P3，Kw"))
        item = self.init_params.item(17, 1)
        item.setText(_translate("MainWindow", ""))
        item = self.init_params.item(18, 0)
        item.setText(_translate("MainWindow", "冷却水泵最多台数,台"))
        item = self.init_params.item(18, 1)
        item.setText(_translate("MainWindow", ""))
        item = self.init_params.item(19, 0)
        item.setText(_translate("MainWindow", "冷却水泵变频频率下限值λ"))
        item = self.init_params.item(19, 1)
        item.setText(_translate("MainWindow", str(model.db.init_params.lamb)))
        item = self.init_params.item(20, 0)
        item.setText(_translate("MainWindow", "冷却塔设定"))
        item = self.init_params.item(21, 0)
        item.setText(_translate("MainWindow", "单台冷却塔的额定流量G，m3/h"))
        item = self.init_params.item(21, 1)
        item.setText(_translate("MainWindow", ""))
        item = self.init_params.item(22, 0)
        item.setText(_translate("MainWindow", "单台冷却塔风量H，m3/h"))
        item = self.init_params.item(22, 1)
        item.setText(_translate("MainWindow", ""))
        item = self.init_params.item(23, 0)
        item.setText(_translate("MainWindow", "单台冷却塔功率P0，Kw"))
        item = self.init_params.item(23, 1)
        item.setText(_translate("MainWindow", str(model.db.init_params.P0)))
        item = self.init_params.item(24, 0)
        item.setText(_translate("MainWindow", "冷却塔最多台数,台"))
        item = self.init_params.item(24, 1)
        item.setText(_translate("MainWindow", ""))
        item = self.init_params.item(25, 0)
        item.setText(_translate("MainWindow", "进出口温差设定"))
        item = self.init_params.item(26, 0)
        item.setText(_translate("MainWindow", "冷冻水进出口温差T2-T1"))
        item = self.init_params.item(26, 1)
        item.setText(_translate("MainWindow", str(model.db.init_params.delta_t1_range[0])))
        item = self.init_params.item(26, 2)
        item.setText(_translate("MainWindow", str(model.db.init_params.delta_t1_range[1])))
        item = self.init_params.item(27, 0)
        item.setText(_translate("MainWindow", "冷却水进出口温差T4-T3"))
        item = self.init_params.item(27, 1)
        item.setText(_translate("MainWindow", str(model.db.init_params.delta_t2_range[0])))
        item = self.init_params.item(27, 2)
        item.setText(_translate("MainWindow", str(model.db.init_params.delta_t2_range[1])))

        self.table_21.setRowCount(len(model.db.main_fittings) + 2)
        # 数据读入-主机设备 数值填充
        for i in range(len(model.db.main_fittings)):
            item = QtWidgets.QTableWidgetItem()
            self.table_21.setItem(i + 2, 0, item)
            item = self.table_21.item(i + 2, 0)
            item.setText(_translate("MainWindow", str(model.db.main_fittings[i].load_percentage)))

            item = QtWidgets.QTableWidgetItem()
            self.table_21.setItem(i + 2, 1, item)
            item = self.table_21.item(i + 2, 1)
            item.setText(_translate("MainWindow", str(model.db.main_fittings[i].q)))

            item = QtWidgets.QTableWidgetItem()
            self.table_21.setItem(i + 2, 3, item)
            item = self.table_21.item(i + 2, 3)
            item.setText(_translate("MainWindow", str(model.db.main_fittings[i].p1)))

            item = QtWidgets.QTableWidgetItem()
            self.table_21.setItem(i + 2, 4, item)
            item = self.table_21.item(i + 2, 4)
            item.setText(_translate("MainWindow", str(model.db.main_fittings[i].t1)))

            item = QtWidgets.QTableWidgetItem()
            self.table_21.setItem(i + 2, 5, item)
            item = self.table_21.item(i + 2, 5)
            item.setText(_translate("MainWindow", str(model.db.main_fittings[i].t2)))

            item = QtWidgets.QTableWidgetItem()
            self.table_21.setItem(i + 2, 6, item)
            item = self.table_21.item(i + 2, 6)
            item.setText(_translate("MainWindow", str(model.db.main_fittings[i].t3)))

            item = QtWidgets.QTableWidgetItem()
            self.table_21.setItem(i + 2, 7, item)
            item = self.table_21.item(i + 2, 7)
            item.setText(_translate("MainWindow", str(model.db.main_fittings[i].t4)))

            item = QtWidgets.QTableWidgetItem()
            self.table_21.setItem(i + 2, 8, item)
            item = self.table_21.item(i + 2, 8)
            item.setText(_translate("MainWindow", str(model.db.main_fittings[i].cop)))

        self.table_22.setRowCount(3)
        # 数据读入-冷冻水泵 数据填充
        # item = self.table_22.item(2, 0)
        # item.setText(_translate("MainWindow", "1"))
        # item = self.table_22.item(2, 1)
        # item.setText(_translate("MainWindow", "冷冻泵 250KQW500-44-90/4"))
        for j in range(5):
            item = QtWidgets.QTableWidgetItem()
            self.table_22.setItem(2, (j + 1) * 2, item)
            item = self.table_22.item(2, (j + 1) * 2)
            item.setText(_translate("MainWindow", str(model.db.pump2_fittings[j].g2)))

            item = QtWidgets.QTableWidgetItem()
            self.table_22.setItem(2, (j + 1) * 2 + 1, item)
            item = self.table_22.item(2, (j + 1) * 2 + 1)
            item.setText(_translate("MainWindow", str(model.db.pump2_fittings[j].p2)))

        self.table_23.setRowCount(3)
        # 数据读入-冷却水泵 数据填充
        # item = self.table_23.item(2, 0)
        # item.setText(_translate("MainWindow", "1"))
        # item = self.table_23.item(2, 1)
        # item.setText(_translate("MainWindow", "冷却泵300KQW600-24-55/4"))
        for j in range(5):
            item = QtWidgets.QTableWidgetItem()
            self.table_23.setItem(2, (j + 1) * 2, item)
            item = self.table_23.item(2, (j + 1) * 2)
            item.setText(_translate("MainWindow", str(model.db.pump3_fittings[j].g3)))

            item = QtWidgets.QTableWidgetItem()
            self.table_23.setItem(2, (j + 1) * 2 + 1, item)
            item = self.table_23.item(2, (j + 1) * 2 + 1)
            item.setText(_translate("MainWindow", str(model.db.pump3_fittings[j].p3)))

        self.table_24.setRowCount(len(model.db.wet_bulb_fittings) + 1)
        # 数据读入-冷却塔 数据填充
        for i in range(len(model.db.wet_bulb_fittings)):
            item = QtWidgets.QTableWidgetItem()
            self.table_24.setItem(i + 1, 0, item)
            item = self.table_24.item(i + 1, 0)
            item.setText(_translate("MainWindow", str(model.db.wet_bulb_fittings[i].temp)))

            item = QtWidgets.QTableWidgetItem()
            self.table_24.setItem(i + 1, 1, item)
            item = self.table_24.item(i + 1, 1)
            item.setText(_translate("MainWindow", str(model.db.wet_bulb_fittings[i].amplitude)))